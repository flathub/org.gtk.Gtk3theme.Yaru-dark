id: org.gtk.Gtk3theme.Yaru-dark
branch: '3.22'
runtime: org.freedesktop.Platform
runtime-version: '20.08'
sdk: org.freedesktop.Sdk
build-extension: true
appstream-compose: false
separate-locales: false
build-options:
  prefix: /usr/share/runtime/share/themes/Yaru-dark/gtk-3.0
modules:
  - name: sassc
    config-opts:
      - --with-libsass=/usr/share/runtime/share/themes/Yaru-dark/gtk-3.0
    cleanup:
      - '*'
    sources:
      - type: archive
        url: https://github.com/sass/sassc/archive/3.6.1.tar.gz
        sha256: 8cee391c49a102b4464f86fc40c4ceac3a2ada52a89c4c933d8348e3e4542a60
      - type: script
        dest-filename: autogen.sh
        commands:
          - autoreconf -si
    modules:
      - name: libsass
        cleanup:
          - '*'
        sources:
          - type: archive
            url: https://github.com/sass/libsass/archive/3.6.4.tar.gz
            sha256: f9484d9a6df60576e791566eab2f757a97fd414fce01dd41fc0a693ea5db2889
          - type: script
            dest-filename: autogen.sh
            commands:
              - autoreconf -si
  - name: Yaru-dark
    buildsystem: meson
    build-options:
      prefix: /usr/share/runtime
      append-path: /usr/share/runtime/share/themes/Yaru-dark/gtk-3.0/bin
      config-opts:
        - -Dicons=false
        - -Dgnome-shell=false
        - -Dgtksourceview=false
        - -Dmetacity=false
        - -Dsounds=false
        - -Dsessions=false
        - -Ddefault=false
        - -Dlight=false
    sources:
      - type: git
        url: https://github.com/ubuntu/yaru.git
        tag: 20.10.4
      - type: shell
        # GNOME only wants 3.0: rename gtk-3.20 folder as gtk-3.0, and modify meson.build accordingly
        commands:
          - rm -r gtk/src/dark/gtk-3.0
          - mv gtk/src/dark/gtk-3.20 gtk/src/dark/gtk-3.0
          - sed -i -e "s/  '3.0,'/  '3.0'/" gtk/src/meson.build
          - sed -i -e "s/  '3.20'//" gtk/src/meson.build
  - name: appdata
    buildsystem: simple
    build-commands:
      - install -Dm644 org.gtk.Gtk3theme.Yaru-dark.appdata.xml ${FLATPAK_DEST}/share/appdata/org.gtk.Gtk3theme.Yaru-dark.appdata.xml
      - appstream-compose --basename=org.gtk.Gtk3theme.Yaru-dark --prefix=${FLATPAK_DEST} --origin=flatpak org.gtk.Gtk3theme.Yaru-dark
    sources:
      - type: file
        path: org.gtk.Gtk3theme.Yaru-dark.appdata.xml
